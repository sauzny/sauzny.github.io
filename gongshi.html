<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <title>文档标题</title>

    <script src="https://gw.alipayobjects.com/as/g/datavis/assets/1.0.1/jquery-3.2.1.min.js"></script>
    <!-- 最新版本的 Bootstrap 核心 CSS 文件 -->
    <link rel="stylesheet" href="https://cdn.bootcss.com/bootstrap/3.3.7/css/bootstrap.min.css"
        integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
    <!-- 可选的 Bootstrap 主题文件（一般不用引入） -->
    <link rel="stylesheet" href="https://cdn.bootcss.com/bootstrap/3.3.7/css/bootstrap-theme.min.css"
        integrity="sha384-rHyoN1iRsVXV4nD0JutlnGaslCJuC7uwjduW9SVrLvRYooPp2bWYgmgJQIXwl/Sp" crossorigin="anonymous">
    <!-- 最新的 Bootstrap 核心 JavaScript 文件 -->
    <script src="https://cdn.bootcss.com/bootstrap/3.3.7/js/bootstrap.min.js"
        integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa"
        crossorigin="anonymous"></script>

    <script type="text/javascript">

        console.log("我不会写页面啊！！！");

        function specialRulesHoursFun(tempDate) {
            var result = [-1, -1];
            // Map<日期, [workHours, overHours]>
            let specialRuleMap = new Map([
                // 月份 要 减1
                [new Date(2021, 1 - 1, 1).getTime(), [0, 0]],
                [new Date(2021, 1 - 1, 2).getTime(), [0, 0]],

                [new Date(2021, 2 - 1, 11).getTime(), [0, 0]],
                [new Date(2021, 2 - 1, 12).getTime(), [0, 0]],
                [new Date(2021, 2 - 1, 13).getTime(), [0, 0]],
                [new Date(2021, 2 - 1, 14).getTime(), [0, 0]],
                [new Date(2021, 2 - 1, 15).getTime(), [0, 0]],
                [new Date(2021, 2 - 1, 16).getTime(), [0, 0]],
                [new Date(2021, 2 - 1, 17).getTime(), [0, 0]],
                [new Date(2021, 2 - 1, 18).getTime(), [0, 0]]
            ]);

            if(specialRuleMap.has(tempDate.getTime())){
                result = specialRuleMap.get(tempDate.getTime()); 
            }

            return result;
        }

        function workHoursFun(tempDate) {
            var result = 0;
            var week = tempDate.getDay();

            switch (week) {
                case 1:
                case 2:
                case 3:
                case 4:
                case 5:
                    result = 8;
                    break;
                case 6:
                case 0:
                    result = 0;
                    break;
            }

            var specialRulesHours = specialRulesHoursFun(tempDate);
            var specialRulesWorkHours = specialRulesHours[0];
            if(specialRulesWorkHours != -1){
                result = specialRulesWorkHours;
            }

            return result;
        }

        function overHoursFun(tempDate) {
            var result = 0;
            var week = tempDate.getDay();

            switch (week) {
                case 1:
                case 2:
                case 4:
                    result = 2;
                    break;
                case 6:
                    result = 8;
                    break;
                case 3:
                case 5:
                case 0:
                    break;
            }

            var specialRulesHours = specialRulesHoursFun(tempDate);
            var specialRulesOverHours = specialRulesHours[1];
            if(specialRulesOverHours != -1){
                result = specialRulesOverHours;
            }

            return result;
        }

        function foo01() {
            var today = new Date();
            var year = today.getFullYear();
            var month = today.getMonth();

            if($("#year").val() != "") year = $("#year").val();
            if($("#month").val() != "") month = $("#month").val() - 1;

            var workHours = 0;
            var overHours = 0;

            // 画表格使用
            $("#tbody").html("");
            $("#year").val(year);
            $("#month").val(month + 1);
            var row = 0;
            var column = 0;

            for (var i = 0; i < 31; i++) {

                var tempDate = new Date(year, month, 1);
                tempDate.setDate(tempDate.getDate() + i);

                if (tempDate.getMonth() != month) break;

                workHours = workHours + workHoursFun(tempDate);
                overHours = overHours + overHoursFun(tempDate);

                var text = "day: " + tempDate.getDate()
                    + "</br><span style='color:green'> work: " + workHours + "</span>"
                    + "</br><span style='color:red'> over: " + overHours + "</span>"
                    + "</br><span style='color:blue'> total: " + (workHours+overHours) + "</span>"
                    ;

                var week = tempDate.getDay();

                if (i == 0 || week == 1) {
                    $("#tbody").append('<tr id="row' + row + '"></tr>');
                }

                if (i == 0 && week != 1) {
                    for (var j = 0; j < week - 1; j++) {
                        $("#row" + row).append('<td id="row' + row + 'column' + j + '"></tr>');
                    }
                }

                $("#row" + row).append('<td id="row' + row + 'column' + column + '">' + text + '</tr>');
                column = column + 1;

                if (week == 0) {
                    row = row + 1;
                    column = 0;
                }
            }
        }


        $(function () {
            foo01();

            $("#submit").click(function () {
                foo01();

            });
        });

    </script>
</head>

<body>

    <div class="container" style="margin-top: 20px;">

        <div class="row">
            <div class="col-md-10 col-md-offset-0" style="background-color: rgb(194, 231, 255);box-shadow: 
            inset 1px -1px 1px #444, inset -1px 1px 1px #444;">

                <form class="navbar-form navbar-left">
                    <div class="form-group">
                        <input type="text" class="form-control" placeholder="年" id="year" />
                        <input type="text" class="form-control" placeholder="月" id="month" />
                    </div>
                    <button type="button" class="btn btn-default" id="submit">Submit</button>
                </form>
                <table class="table">
                    <caption>没有任何意义的表格，需要排除的日期可以在issues里告诉我！</caption>
                    <thead>
                        <tr>
                            <th>星期一</th>
                            <th>星期二</th>
                            <th>星期三</th>
                            <th>星期四</th>
                            <th>星期五</th>
                            <th>星期六</th>
                            <th>星期日</th>
                        </tr>
                    </thead>
                    <tbody id="tbody">
                    </tbody>
                </table>
            </div>
        </div>
    </div>
</body>

</html>